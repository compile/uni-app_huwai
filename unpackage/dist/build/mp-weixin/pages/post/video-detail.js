(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/post/video-detail"],{3429:function(t,e,n){"use strict";(function(t){n("251e");o(n("66fd"));var e=o(n("e29d"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},"34a4":function(t,e,n){},"414d":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{postDetail:{content:"",userInfo:{username:""}},isSubmitD:!1,commentPopup:!1,commentList:[],focus:!1,placeholder:"说点什么...",page:1,form:{pid:0,type:1,to_uid:"",post_id:"",content:""},loadStatus:"loadmore"}},filters:{replace:function(t){return t=t.replace(/\n/g,""),t.length>20&&(t=t.substring(0,20)+"..."),t}},onLoad:function(t){this.postId=t.id,t.scene&&(this.postId=t.scene),this.form.post_id=this.postId,this.getPostDetail(),this.getCommentList()},methods:{delComment:function(e,n,o){var i=this,s=t.getStorageSync("userInfo");e.uid==s.uid&&t.showModal({title:"提示",content:"确定删除该评论？",success:function(t){t.confirm?i.$H.post("comment/del",{id:e.id}).then((function(t){200==t.code&&(o||0===o?i.commentList[n].children.splice(o,1):i.commentList.splice(n,1))})):t.cancel}})},onCopy:function(){var e=this;t.setClipboardData({data:this.postDetail.content,success:function(){t.hideToast(),e.$q.toast("复制成功","success")}})},reachBottom:function(){this.page++,this.getCommentList()},jumpUser:function(e){t.navigateTo({url:"/pages/user/home?uid="+e})},onThumbs:function(t,e,n){var o=this;this.$H.post("comment/thumbs",{id:t}).then((function(t){200==t.code&&(n||0==n?(o.commentList[e].children[n].is_thumbs=!0,o.commentList[e].children[n].thumbs++):(o.commentList[e].is_thumbs=!0,o.commentList[e].thumbs++))}))},cancelThumbs:function(t,e,n){var o=this;console.log(e+","+n),this.$H.post("comment/cancelThumbs",{id:t}).then((function(t){200==t.code&&(n||0==n?(o.commentList[e].children[n].is_thumbs=!1,o.commentList[e].children[n].thumbs--):(o.commentList[e].is_thumbs=!1,o.commentList[e].thumbs--))}))},onReply:function(t){this.placeholder="回复："+t.userInfo.username,this.focus=!0;var e=t.pid;this.form.pid=0===e?t.id:t.pid,this.form.to_uid=t.userInfo.uid,this.form.post_id=this.postId},onBlur:function(){this.placeholder="说点什么...",this.focus=!1,this.pid=0},getCommentList:function(){var t=this;this.loadStatus="loading",this.$H.get("comment/list",{post_id:this.postId,page:this.page}).then((function(e){200==e.code&&(t.commentList=t.commentList.concat(e.result.data),e.result.current_page===e.result.last_page||0===e.result.last_page?t.loadStatus="nomore":t.loadStatus="loadmore")}))},cancelCollection:function(){var t=this;this.$H.post("post/cancelCollection",{id:this.postId}).then((function(e){200===e.code&&(t.postDetail.collection_count--,t.postDetail.is_collection=!1)}))},addCollection:function(){var t=this;this.$H.post("post/addCollection",{id:this.postId,uid:this.postDetail.uid}).then((function(e){200===e.code&&(t.postDetail.collection_count++,t.postDetail.is_collection=!0)}))},addComment:function(){var e=this;if(this.isSubmitD=!0,""==this.form.content)return this.$u.toast("评论不能为空"),void(this.isSubmitD=!1);t.showLoading({mask:!0,title:"发布中"}),this.$H.post("post/addComment",this.form).then((function(n){200==n.code&&(e.form.content="",e.$u.toast("评论成功"),e.page=1,e.commentList=[],e.getCommentList()),e.isSubmitD=!1,t.hideLoading()}))},getPostDetail:function(){var t=this;this.$H.get("post/detail",{id:this.postId}).then((function(e){t.postDetail=e.result}))}},onShareAppMessage:function(t){return"button"===t.from&&console.log(t.target),this.postDetail.media.length>0&&this.postDetail.media[0],{title:this.postDetail.content,path:"/pages/post/video-detail?id="+this.postId}},onShareTimeline:function(){this.postDetail.media[0];return{title:this.postDetail.content,query:"id="+this.postId}}};e.default=n}).call(this,n("543d")["default"])},"557c":function(t,e,n){"use strict";n.r(e);var o=n("414d"),i=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=i.a},"7ac8":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o}));var o={uAvatar:function(){return n.e("uview-ui/components/u-avatar/u-avatar").then(n.bind(null,"c135"))},qPopup:function(){return n.e("uni_modules/q-view/components/q-popup/q-popup").then(n.bind(null,"b976"))},uIcon:function(){return n.e("uview-ui/components/u-icon/u-icon").then(n.bind(null,"312f"))},uLoadmore:function(){return n.e("uview-ui/components/u-loadmore/u-loadmore").then(n.bind(null,"99cd"))},uEmpty:function(){return n.e("uview-ui/components/u-empty/u-empty").then(n.bind(null,"3977"))},uButton:function(){return n.e("uview-ui/components/u-button/u-button").then(n.bind(null,"fa8a"))}},i=function(){var t=this,e=t.$createElement,n=(t._self._c,t._f("replace")(t.postDetail.content)),o=t._f("timeFrom")(t.postDetail.create_time),i=t.__map(t.commentList,(function(e,n){var o=t.__get_orig(e),i=t._f("timeFrom")(e.create_time),s=t.__map(e.children,(function(n,o){var i=t.__get_orig(n),s=e.children.length>0?t._f("timeFrom")(n.createtime):null;return{$orig:i,f3:s}}));return{$orig:o,f2:i,l0:s}}));t._isMounted||(t.e0=function(e){t.commentPopup=!0}),t.$mp.data=Object.assign({},{$root:{f0:n,f1:o,l1:i}})},s=[]},c24a:function(t,e,n){"use strict";var o=n("34a4"),i=n.n(o);i.a},e29d:function(t,e,n){"use strict";n.r(e);var o=n("7ac8"),i=n("557c");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("c24a");var u,c=n("f0c5"),a=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"522aec30",null,!1,o["a"],u);e["default"]=a.exports}},[["3429","common/runtime","common/vendor"]]]);